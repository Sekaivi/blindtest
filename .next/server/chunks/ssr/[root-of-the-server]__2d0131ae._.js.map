{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/roxis/Documents/Travail/MMI/S5/R505%20-%20Dev%20front/app-react/blindtest_next/src/stores/authContext.js"],"sourcesContent":["'use client';\r\nimport { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport Link from 'next/link';\r\n\r\nconst AuthContext = createContext();\r\nexport const useAuth = () => useContext(AuthContext);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const router = useRouter();\r\n    const [user, setUser] = useState(null);\r\n    const [token, setToken] = useState(null);\r\n    const [error, setError] = useState(null);\r\n\r\n    // Au chargement, restore user et token depuis localStorage\r\n    useEffect(() => {\r\n        const storedUser = localStorage.getItem('user');\r\n        const storedToken = localStorage.getItem('token');\r\n        if (storedUser && storedToken) {\r\n            setUser(JSON.parse(storedUser));\r\n            setToken(storedToken);\r\n        }\r\n    }, []);\r\n\r\n    const login = async (mail, password) => {\r\n        try {\r\n            const res = await fetch('/api/auth/login', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ mail, password }),\r\n            });\r\n            const data = await res.json();\r\n            if (!res.ok) {\r\n                setError(data.error || 'Erreur de connexion');\r\n                return false;\r\n            }\r\n            setUser(data.user);\r\n            setToken(data.token);\r\n            // Persister dans localStorage\r\n            localStorage.setItem('user', JSON.stringify(data.user));\r\n            localStorage.setItem('token', data.token);\r\n            setError(null);\r\n            router.push('/jeu/page.js');\r\n            return true;\r\n        } catch (err) {\r\n            setError('Erreur serveur');\r\n            return false;\r\n        }\r\n    };\r\n\r\n    const register = async ({ name, mail, password }) => {\r\n        try {\r\n            const res = await fetch('/api/auth/register', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ name, mail, password }),\r\n            });\r\n            const data = await res.json();\r\n            if (!res.ok) {\r\n                setError(data.error || 'Erreur lors de la crÃ©ation du compte');\r\n                return false;\r\n            }\r\n            setError(null);\r\n            return true;\r\n        } catch (err) {\r\n            setError('Erreur serveur');\r\n            return false;\r\n        }\r\n    };\r\n\r\n    const logout = () => {\r\n        setUser(null);\r\n        setToken(null);\r\n        setError(null);\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('token');\r\n        router.push('/login');\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, token, error, login, register, logout }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AACA;AAHA;;;;;AAKA,MAAM,4BAAc,IAAA,sNAAa;AAC1B,MAAM,UAAU,IAAM,IAAA,mNAAU,EAAC;AAEjC,MAAM,eAAe,CAAC,EAAE,QAAQ,EAAE;IACrC,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IAEnC,2DAA2D;IAC3D,IAAA,kNAAS,EAAC;QACN,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,MAAM,cAAc,aAAa,OAAO,CAAC;QACzC,IAAI,cAAc,aAAa;YAC3B,QAAQ,KAAK,KAAK,CAAC;YACnB,SAAS;QACb;IACJ,GAAG,EAAE;IAEL,MAAM,QAAQ,OAAO,MAAM;QACvB,IAAI;YACA,MAAM,MAAM,MAAM,MAAM,mBAAmB;gBACvC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAM;gBAAS;YAC1C;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;gBACT,SAAS,KAAK,KAAK,IAAI;gBACvB,OAAO;YACX;YACA,QAAQ,KAAK,IAAI;YACjB,SAAS,KAAK,KAAK;YACnB,8BAA8B;YAC9B,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC,KAAK,IAAI;YACrD,aAAa,OAAO,CAAC,SAAS,KAAK,KAAK;YACxC,SAAS;YACT,OAAO,IAAI,CAAC;YACZ,OAAO;QACX,EAAE,OAAO,KAAK;YACV,SAAS;YACT,OAAO;QACX;IACJ;IAEA,MAAM,WAAW,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE;QAC5C,IAAI;YACA,MAAM,MAAM,MAAM,MAAM,sBAAsB;gBAC1C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAM;oBAAM;gBAAS;YAChD;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;gBACT,SAAS,KAAK,KAAK,IAAI;gBACvB,OAAO;YACX;YACA,SAAS;YACT,OAAO;QACX,EAAE,OAAO,KAAK;YACV,SAAS;YACT,OAAO;QACX;IACJ;IAEA,MAAM,SAAS;QACX,QAAQ;QACR,SAAS;QACT,SAAS;QACT,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,OAAO,IAAI,CAAC;IAChB;IAEA,qBACI,8OAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAO;YAAO;YAAO;YAAU;QAAO;kBACtE;;;;;;AAGb","debugId":null}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/roxis/Documents/Travail/MMI/S5/R505%20-%20Dev%20front/app-react/blindtest_next/src/components/Connexion.js"],"sourcesContent":["'use client';\r\n\r\nimport { useAuth } from \"@/stores/authContext\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport { useEffect } from \"react\";\r\n\r\nexport default function Connexion({ children }) {\r\n    const { user } = useAuth();\r\n    const router = useRouter();\r\n    const pathname = usePathname();\r\n\r\n    const isLoginPage = pathname === \"/login\";\r\n\r\n    useEffect(() => {\r\n        if (!user && !isLoginPage) {\r\n            router.replace(\"/login\");\r\n        }\r\n    }, [user, pathname]);\r\n\r\n    if (!user && !isLoginPage) return null;\r\n\r\n    return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS,UAAU,EAAE,QAAQ,EAAE;IAC1C,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,uIAAO;IACxB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,WAAW,IAAA,iJAAW;IAE5B,MAAM,cAAc,aAAa;IAEjC,IAAA,kNAAS,EAAC;QACN,IAAI,CAAC,QAAQ,CAAC,aAAa;YACvB,OAAO,OAAO,CAAC;QACnB;IACJ,GAAG;QAAC;QAAM;KAAS;IAEnB,IAAI,CAAC,QAAQ,CAAC,aAAa,OAAO;IAElC,qBAAO;kBAAG;;AACd","debugId":null}}]
}